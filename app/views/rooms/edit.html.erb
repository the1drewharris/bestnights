<header>
  <h1 class="prop-title">Edit Room</h1>
</header>
  <div id="container-main" class="editrooms">
    <!-- <form accept-charset="UTF-8" action="/rooms/1" class="edit_room" id="edit_room_1" method="post"> -->
    <%= form_for @room, :html => {:class => "edit_room", :id => "edit_room_1"} do |f| %>
      <div style="margin:0;padding:0;display:inline">
        <input name="utf8" type="hidden" value="&#x2713;" />
        <input name="_method" type="hidden" value="put" />
        <input name="authenticity_token" type="hidden" value="6tqlXrsLLQZxGVd1I6PkAKSSl3nVh/jZueuuSuDEkrI=" />
      </div>
      <fieldset>
			  <ul>
			  	<li>
			  		<%= f.label :name %>
			  		<%= f.text_field(:name, class: "textfield") %>
			  	</li>		  	
			  	<li>
		  		<label>Monday Price</label>
		  			<%= text_field_tag 'rate_monday', @room.room_rates.blank? ? "" : number_with_precision(@room.room_rates.last.rate_monday, :precision => 2, :separator => '.', :delimiter => ',') %>
			  	</li>
			  	<li>
			  		<label>Tuesday Price</label>
			  		<%= text_field_tag 'rate_tuesday', @room.room_rates.blank? ? "" : number_with_precision(@room.room_rates.last.rate_tuesday, :precision => 2, :separator => '.', :delimiter => ',') %>
			  	</li>
			  	<li>
			  		<label>Wednesday Price</label>
			  		<%= text_field_tag 'rate_wednesday', @room.room_rates.blank? ? "" : number_with_precision(@room.room_rates.last.rate_wednesday, :precision => 2, :separator => '.', :delimiter => ',') %>
			  	</li>
			  	<li>
			  		<label>Thursday Price</label>
			  		<%= text_field_tag 'rate_thursday', @room.room_rates.blank? ? "" : number_with_precision(@room.room_rates.last.rate_thursday, :precision => 2, :separator => '.', :delimiter => ',') %>
			  	</li>
			  	<li>
			  		<label>Friday Price</label>
			  		<%= text_field_tag 'rate_friday', @room.room_rates.blank? ? "" : number_with_precision(@room.room_rates.last.rate_friday, :precision => 2, :separator => '.', :delimiter => ',') %>
			  	</li>
			  	<li>
			  		<label>Saturday Price</label>
			  		<%= text_field_tag 'rate_saturday', @room.room_rates.blank? ? "" : number_with_precision(@room.room_rates.last.rate_saturday, :precision => 2, :separator => '.', :delimiter => ',') %>
			  	</li>
			  	<li>
			  		<label>Sunday Price</label>
			  		<%= text_field_tag 'rate_sunday', @room.room_rates.blank? ? "" : number_with_precision(@room.room_rates.last.rate_sunday, :precision => 2, :separator => '.', :delimiter => ',') %>
			  	</li>
			  	<li>
			  		<%= f.label "Addional adult fee" %>
			  		<%= f.text_field(:additionaladultfee, class: "textfield") %>
			  	</li>
			  	<li>
			  		<%= f.label :starting_inventory %>
			  		<%= f.text_field(:starting_inventory, class: "textfield") %>
			  	</li>
			  	<li>
			  		<%= f.label "Bed Numbers" %>
			  		<%= f.text_field(:bed_numbers, class: "textfield") %>
			  	</li>
			  	<li>
			  		<%= f.label :lunch %>
			  		<%= f.check_box(:lunch, class: "check") %>
			  	</li>
			  	<li>
		  		<%= f.label :dinner %>
		  		<%= f.check_box(:dinner, class: "check") %>
		  	</li>
		  	<li>
		  		<%= f.label :all_inclusive %>
		  		<%= f.check_box(:all_inclusive, class: "check") %>
		  	</li><br />
		  	<% if current_user.new_signup? %>
		  		<%= f.hidden_field :hotel_id, :value => @hotel.id %>
		  	<% else %>
			  	<li>
			  		<%= f.label :hotel %>
			  		<%= f.select :hotel_id, options_for_select(@hotels.map{|s|[s.name, s.id]}, @room.hotel.id), {}, {class: "selectbox"} %>
			  	</li>
		  	<% end %>
		  	<li>
		  		<%= f.label "Room Type" %>
		  		<%= f.select :room_type_id, options_for_select(RoomType.all.map{|s|[s.room_type, s.id]}, @room.room_type.id), {}, {class: "selectbox"} %>
		  	</li>	
		  	<li class="flwidth">
		  		<%= f.label :description %>
		  		<%= f.text_area :description, class: "textarea" %>
		  	</li>
		  	<li class="flwidth">							
					<label for="client_photos">Photos</label>
					<div class="dropzone" id="room-dropzone" />
				</li>
		  	<li class="flwidth">
					<span class="formLabel">Amenities and Facilities</span>
					<div class="checklist">
						<ul>
							<% @room_attributes.each do |attr| %>
								<li>
									<input name="client[attributes][<%= attr.id %>]" type="checkbox" class="check" <%= "checked" if attr.rooms.include?(@room) %>>
									<label for="client[attributes]"><%= attr.attr %></label>
								</li>
							<% end %>
						</ul>
					</div>
				</li>
		  </ul>	
		</fieldset>
    <fieldset class="formactions">
      <input name="commit" type="submit" value="Update Room" />
    </fieldset>
  <!-- </form> -->
  <% end %>
</div>


<script type="text/javascript">
	$(document).ready(function(){			
		Dropzone.options.roomDropzone = {
			url: "/room_photos/1",
			addRemoveLinks: true,
			dictRemoveFileConfirmation: "Are you sure you want to remove this file?",
			paramName: "picture",
			success: function(file, response){
				file.id = response.id
			},
			init: function () {
					var mockFile = {id: "13", name: "bestnights_coming_soon.jpg", size: "1021941", type: "image/jpeg" };
					this.options.addedfile.call(this, mockFile);
					this.options.thumbnail.call(this, mockFile, "assets/bestnights_coming_soon.jpg");
					var mockFile = {id: "14", name: "130U3304A5.jpg", size: "61407", type: "image/jpeg" };
					this.options.addedfile.call(this, mockFile);
					this.options.thumbnail.call(this, mockFile, "assets/130U3304A5.jpg");
      },
      removedfile: function(file) {				
				$.ajax({
					type: 'DELETE',
					url: "/room_photos",
					data: { id: file.id, status: file.status},
					dataType: 'json'
					});
					var _ref;
					return (_ref = file.previewElement) != null ? _ref.parentNode.removeChild(file.previewElement) : void 0; 
      
			}		 
		}
	});
	
</script>