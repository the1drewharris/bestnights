<div id="wrapper" class="home">
	<div id="eyebrow">
		<%= render :partial => "common/home_nav_tab" %>
	</div>	
	<div id="searchpane" class="calbg">
		<!-- <form id="searchform"> -->
		<form id="searchform" method="get" action="/hotels/search" accept-charset="UTF-8" >	
			<div style="margin-bottom:6px;"> Click Check-in and Check-out Dates to Search Availability </div>
			<input type="hidden" id="checkindate" name="date[checkin]" value=<%= session[:checkin] %> >
			<input type="hidden" id="checkoutdate" name="date[checkout]" value=<%= session[:checkout] %> >
			<input type="hidden" id="roomtype" name="roomtype" value="">
			<span role="status" aria-live="polite" class="ui-helper-hidden-accessible"></span>
			<input type="text" placeholder="Enter Destination..." value="<%= session[:search] %>" data-autocomplete="/home/autocomplete_hotel_name" id="hotel_name" name="search" class="ui-autocomplete-input inputCText" autocomplete="off">
			<input type="submit" class="demo_button_submit" style="visibility: hidden;position: absolute;"/>
				
			<!-- if blank, use this
			<span class="checkindate"><span>Check in</span><span></span><span></span><br><span></span></span>
			<span class="checkoutdate"><span>Check out</span><span></span><span></span><br><span></span></span>
			 -->
			
			<!-- else, prepopulated -->
			<span class="checkindate" id="check-in"><span>Check in</span><input type="text" value="<%= Date.today.strftime("%A, %-d") %><%= Date.today.strftime("%B %Y") %>" class="intime inputCheck"/></span>
			<span class="checkoutdate" id="check-out"><span>Check out</span><input type="text" value="<%= Date.today.strftime("%A, %-d") %><%= Date.today.strftime("%B %Y") %>" class="outtime inputCheck"/></span>
			
				
				
			<div style="display:inline-block;">
			<div class="bookingdates">
				<div class="searchpicker"><input class="datepicker1"></div>
				<ul id="roomtypes" class="roomtypes">
					<li value="1" class=""><a><span class="booking-sngl"></span><em>Single Room</em></a></li>
					<li value="2" class="selected"><a><span class="booking-dble"></span><em>Double Room</em></a></li>
					<li value="3" class=""><a><span class="booking-grp"></span><em>Groups</em></a></li>
				</ul>
				<div class="groupopts">
					<label for="roomqty">Number of Rooms</label>
					<!-- <input name="roomqty[0]" class="roomqty" type="number" min="1" value="1"> -->
					<input name="group[roomqty]" id="roomqty" class="roomqty" type="number" min="1" value="1">
					<ul>
						<li>
							<h5>Room 1</h5>
							<ul>
								<li>
									<label>Adults</label>
									<!-- <input name="adultqty[1]" type="number" min="0" value="1"> -->
									<input name="group[beds][1][adultqty]" type="number" min="0" value="1" max="2">
								</li>
								<li>
									<label>Children</label>
									<!-- <input name="childqty[1]" type="number" min="0" value="0"> -->
									<input name="group[beds][1][childqty]" type="number" min="0" value="0">
								</li>
							</ul>
						</li>
					</ul>
				</div>
			</div>
			<div id="searchpaneui" class="calClose">
				<input type="submit" value="Search" name="submit" class="searchButton">
				<a class="button4" href="#">Close</a>
			</div>
			</div>
			<div id="searchresults">
				<h5>Top Results</h5>
				<ul>
					<!-- #TODO We need to make this show dynamic search results via JavaScript --> 
					<% Hotel.top5.each do |hotel| %>
						<li>
							
							<%= link_to booking_detail_path(:hotel_id => hotel.id) do %>
							  <% unless hotel.hotel_photos.empty? %>
							  	<img src=<%= hotel.hotel_photos.first.picture.url %> alt="" style="width:97px;height:74px;" />
							  <% end %>
								<!-- <img src=<%= hotel.hotel_photos.first.picture.url unless hotel.hotel_photos.empty? %> size="97x74" alt="" /> -->
								<b><%= hotel.name %></b><br>
								<span class="starrating">
									<% unless hotel.star.blank? %>
										<% hotel.star.to_i.times do %>
							  			&#10029;
							  			<% end %>
							  		<% end %>
							  </span><br><%= hotel.city %>, <% unless hotel.state.blank? %><%= hotel.state.state_province %><% end %>
							<% end %>
						</li>
					<% end %>
				</ul>
				<p><a class="button4" href="#">See More Results</a></p>
			</div>
		</form>
	</div>
	<div id="features">
		<ul>
			<li data-row="1" data-col="1" data-sizex="2" data-sizey="1" style="background:url(assets/siteimages/grid-1_1.jpg) no-repeat top left;"></li>
			<li data-row="2" data-col="1" data-sizex="2" data-sizey="1"><span>Save with <br>every stay</span></li>
			<li data-row="3" data-col="1" data-sizex="1" data-sizey="1" style="background:url(assets/siteimages/grid-1_3.jpg) no-repeat top left;"></li>
			<li data-row="4" data-col="1" data-sizex="1" data-sizey="1" style="background:url(assets/siteimages/grid-1_4.jpg) no-repeat top left;"></li>
	 
			<li data-row="3" data-col="2" data-sizex="1" data-sizey="2" style="background:url(assets/siteimages/grid-2_3.jpg) no-repeat top left;"></li>
	 
			<li data-row="1" data-col="3" data-sizex="3" data-sizey="3" style="background:url(assets/siteimages/grid-3_1.jpg) no-repeat top left;"><span>Your night just got better<br />with BestNights.com</span></li>
			<li data-row="4" data-col="3" data-sizex="1" data-sizey="1" style="background:url(assets/siteimages/grid-3_4.jpg) no-repeat top left;"></li>
	 
			<li data-row="4" data-col="4" data-sizex="1" data-sizey="1" style="background:url(assets/siteimages/grid-4_4.jpg) no-repeat top left;"></li>
	 
			<li data-row="4" data-col="5" data-sizex="2" data-sizey="1"><span>Last Minute Deals<br>Don&rsquo;t Wait to Get Away</span></li>
	 
			<li data-row="1" data-col="6" data-sizex="1" data-sizey="1" style="background:url(assets/siteimages/grid-6_1.jpg) no-repeat top left;"></li>
			<li data-row="2" data-col="6" data-sizex="1" data-sizey="1" style="background:url(assets/siteimages/grid-6_2.jpg) no-repeat top left;"></li>
			<li data-row="3" data-col="6" data-sizex="1" data-sizey="1" style="background:url(assets/siteimages/grid-6_3.jpg) no-repeat top left;"></li>
	 
		</ul>
	</div>
	<header>
		<h1>Discover<br>the Latest Hotel Deals</h1>
		<ul id="latestdeals">
			<% @grouped_hotels.first(4).each do |group_hotel| %>
			  <% city = group_hotel.first %>
			  <% hotels = group_hotel.last %>
			  <li>
					<h4><%= city %></h4>
					<!--<p> #TODO Need  #count  Deals are available today</p>-->
					<ul>
						<% hotels.each do |hotel| %>
						  <li>
						  	<%= link_to hotel.name, booking_detail_path(:hotel_id => hotel.id) %><br>
						  	<% hotel.star.to_i.times do %>
						  		&#10029;
						  	<% end %>							  	
						  </li>
						<% end %>
					</ul>
				</li>
			<% end %>
			
		</ul>
	</header>
	
	<section id="latesthotels">
		<p class="options"><a href="#">Newest</a> &bull; <a href="#">Popular</a> <!-- Most booked hotel list --></p>
		<h3>Take a look at the latest hotels who just joined.</h3>
		<p>
			<% @latest_joined_hotels.each do |hotel| %>
				<% unless hotel.hotel_photos.empty? %>
				<%= link_to image_tag(hotel.hotel_photos.first.picture.url, style: "width:72px;height:72px;"), "#" %>
					<!-- <a><%= image_tag hotel.hotel_photos.first.picture.url , size: "72x72" %></a> -->
				<% end %>
				
			<% end %>
		</p>
		<!-- <a href="#">View all new hotels</a> -->
	</section>
	<!--
		<section class="callout">
		<h3>Get the latest deals on your hotel bookings.</h3>
		<p>Registering will keep you up-to-date with the latest deals available!</p>
		<a class="button3" href="/users/sign_up">Register Now, It&rsquo;s Free!</a>
	</section>
	-->
	
	<%= render :partial => "common/home_footer" %>
	
</div>

<script>
	var kept_prv = (new Date("<%= session[:checkin] %>")).getTime(); // kept date
	var kept_cur = (new Date("<%= session[:checkout] %>")).getTime(); // kept date
	var kept_roomtype = "<%= session[:roomtype] %>";
	var kept_group = gon.group;	
	
	console.log(kept_roomtype);
	console.log(kept_group);
</script>

<script>
	$(document).ready(function(){
		$("#searchform").find('input').keypress(function(e){
			if(e.which == 13){
				return false;
			}
		})
	})
</script>
